
/* Script DDL de création du schema de la base de données  */
/* .................................................................................... */


/* Informations générales */

CREATE TABLE T_S_DATABASE_INFO_DBI (
  DBI_INFO  TEXT(128) NOT NULL,
  DBI_TYPE  TEXT(12)  NOT NULL,
  DBI_VALUE TEXT(255) NOT NULL,
  CONSTRAINT C_DBI_KP PRIMARY KEY (DBI_INFO))^

INSERT INTO T_S_DATABASE_INFO_DBI VALUES ('Language', 'TEXT', 'En')^
INSERT INTO T_S_DATABASE_INFO_DBI VALUES ('Version' , 'TEXT', 'v1.0.0.0')^

/* Informations sur les tables */

CREATE TABLE T_S_TABLE_TBL (  TBL_NAME TEXT(32),
  CONSTRAINT C_TBL_KP PRIMARY KEY (TBL_NAME))^

INSERT INTO T_S_TABLE_TBL VALUES ("T_INTERVIEWER_IVW")^
INSERT INTO T_S_TABLE_TBL VALUES ("T_HOUSEHOLD_HSH")^
INSERT INTO T_S_TABLE_TBL VALUES ("T_INTERVIEWSUPERVISOR_IVW")^
INSERT INTO T_S_TABLE_TBL VALUES ("T_SURVEYTYPIST_ISV")^
INSERT INTO T_S_TABLE_TBL VALUES ("T_SURVEYSUPERVISOR_STP")^

/* Informations sur les champs */

CREATE TABLE T_S_FIELD_FLD (
  FLD_TABLE          TEXT(32) NOT NULL,
  FLD_NAME           TEXT(32) NOT NULL,
  FLD_NAME_DBF       TEXT(32),
  FLD_POSITION       SMALLINT NOT NULL,
  FLD_ATTRIBUTES     SMALLINT NOT NULL,
  FLD_DEFAULT_VALUE  TEXT(32),
  FLD_REQUIRED       LOGICAL NOT NULL,
  FLD_READONLY       LOGICAL NOT NULL,
  FLD_SIZE           SMALLINT NOT NULL,
  FLD_TYPE           TEXT(32) NOT NULL,
  FLD_VALIDATION_RULE TEXT(100),
  FLD_VALIDATION_TEXT TEXT(255),
  CONSTRAINT C_FLD_KP PRIMARY KEY (FLD_TABLE, FLD_NAME))^

CREATE TABLE T_S_FIELD_TRANSLATION_FTL (
  FTL_TABLE          TEXT(32),
  FTL_NAME           TEXT(32) NOT NULL,
  FTL_NAME_UI        TEXT(32) NOT NULL,
  FTL_LANGUAGE       TEXT(2) NOT NULL,
  CONSTRAINT C_FTL_KP PRIMARY KEY (FTL_TABLE, FTL_NAME, FTL_LANGUAGE))^

CREATE VIEW V_S_FIELD_FLD AS
  PARAMETERS [LANG] TEXT(2);
  SELECT
    FLD_TABLE,
    FLD_NAME,
    FTL_NAME_UI AS FLD_NAME_UI,
    FLD_NAME_DBF,
    FLD_POSITION,
    FLD_ATTRIBUTES,
    FLD_DEFAULT_VALUE,
    FLD_REQUIRED,
    FLD_READONLY,
    FLD_SIZE,
    FLD_TYPE,
    FLD_VALIDATION_RULE,
    FLD_VALIDATION_TEXT
  FROM
    T_S_FIELD_FLD,
    T_S_FIELD_TRANSLATION_FTL
  WHERE
    (FLD_TABLE = FTL_TABLE) AND
    (FLD_NAME  = FTL_NAME) AND
    (FTL_LANGUAGE=[LANG])^

INSERT INTO T_S_FIELD_FLD             VALUES ("T_INTERVIEWER_IVW", "IVW_PRIMARYKEY", "??", 0, 0, "", TRUE, FALSE, 4, "AUTOINCREMENT", "", "?? is a integer field mandatory")^
INSERT INTO T_S_FIELD_TRANSLATION_FTL VALUES ("T_INTERVIEWER_IVW", "IVW_PRIMARYKEY", "??", "En")^
INSERT INTO T_S_FIELD_TRANSLATION_FTL VALUES ("T_INTERVIEWER_IVW", "IVW_PRIMARYKEY", "??", "Fr")^
INSERT INTO T_S_FIELD_FLD             VALUES ("T_INTERVIEWER_IVW", "IVW_NAMEFIRST", "??", 1, 0, "", FALSE, FALSE, 32, "VARCHAR(32)", "", "?? is a text field of 32 char(s)")^
INSERT INTO T_S_FIELD_TRANSLATION_FTL VALUES ("T_INTERVIEWER_IVW", "IVW_NAMEFIRST", "??", "En")^
INSERT INTO T_S_FIELD_TRANSLATION_FTL VALUES ("T_INTERVIEWER_IVW", "IVW_NAMEFIRST", "??", "Fr")^
INSERT INTO T_S_FIELD_FLD             VALUES ("T_INTERVIEWER_IVW", "IVW_NAMELAST", "??", 2, 0, "", FALSE, FALSE, 32, "VARCHAR(32)", "", "?? is a text field of 32 char(s)")^
INSERT INTO T_S_FIELD_TRANSLATION_FTL VALUES ("T_INTERVIEWER_IVW", "IVW_NAMELAST", "??", "En")^
INSERT INTO T_S_FIELD_TRANSLATION_FTL VALUES ("T_INTERVIEWER_IVW", "IVW_NAMELAST", "??", "Fr")^
INSERT INTO T_S_FIELD_FLD             VALUES ("T_HOUSEHOLD_HSH", "HSH_PRIMARY_KEY", "??", 0, 0, "", TRUE, FALSE, 4, "AUTOINCREMENT", "", "?? is a integer field mandatory")^
INSERT INTO T_S_FIELD_TRANSLATION_FTL VALUES ("T_HOUSEHOLD_HSH", "HSH_PRIMARY_KEY", "??", "En")^
INSERT INTO T_S_FIELD_TRANSLATION_FTL VALUES ("T_HOUSEHOLD_HSH", "HSH_PRIMARY_KEY", "??", "Fr")^
INSERT INTO T_S_FIELD_FLD             VALUES ("T_HOUSEHOLD_HSH", "HSH_IDENTIFIER_OF_CLUSTER", "??", 1, 0, "", FALSE, FALSE, 32, "VARCHAR(32)", "", "?? is a text field of 32 char(s)")^
INSERT INTO T_S_FIELD_TRANSLATION_FTL VALUES ("T_HOUSEHOLD_HSH", "HSH_IDENTIFIER_OF_CLUSTER", "??", "En")^
INSERT INTO T_S_FIELD_TRANSLATION_FTL VALUES ("T_HOUSEHOLD_HSH", "HSH_IDENTIFIER_OF_CLUSTER", "??", "Fr")^
INSERT INTO T_S_FIELD_FLD             VALUES ("T_HOUSEHOLD_HSH", "HSH_IDENTIFIER_OF_HOUSEHOLD", "??", 2, 0, "", FALSE, FALSE, 32, "VARCHAR(32)", "", "?? is a text field of 32 char(s)")^
INSERT INTO T_S_FIELD_TRANSLATION_FTL VALUES ("T_HOUSEHOLD_HSH", "HSH_IDENTIFIER_OF_HOUSEHOLD", "??", "En")^
INSERT INTO T_S_FIELD_TRANSLATION_FTL VALUES ("T_HOUSEHOLD_HSH", "HSH_IDENTIFIER_OF_HOUSEHOLD", "??", "Fr")^
INSERT INTO T_S_FIELD_FLD             VALUES ("T_HOUSEHOLD_HSH", "HSH_INTERVIEW_SUPERVISOR", "??", 3, 0, "", FALSE, FALSE, 4, "LONG", "", "?? is a integer field")^
INSERT INTO T_S_FIELD_TRANSLATION_FTL VALUES ("T_HOUSEHOLD_HSH", "HSH_INTERVIEW_SUPERVISOR", "??", "En")^
INSERT INTO T_S_FIELD_TRANSLATION_FTL VALUES ("T_HOUSEHOLD_HSH", "HSH_INTERVIEW_SUPERVISOR", "??", "Fr")^
INSERT INTO T_S_FIELD_FLD             VALUES ("T_HOUSEHOLD_HSH", "HSH_INTERVIEWER", "??", 4, 0, "", FALSE, FALSE, 4, "LONG", "", "?? is a integer field")^
INSERT INTO T_S_FIELD_TRANSLATION_FTL VALUES ("T_HOUSEHOLD_HSH", "HSH_INTERVIEWER", "??", "En")^
INSERT INTO T_S_FIELD_TRANSLATION_FTL VALUES ("T_HOUSEHOLD_HSH", "HSH_INTERVIEWER", "??", "Fr")^
INSERT INTO T_S_FIELD_FLD             VALUES ("T_HOUSEHOLD_HSH", "HSH_SURVEY_TYPIST", "??", 5, 0, "", FALSE, FALSE, 4, "LONG", "", "?? is a integer field")^
INSERT INTO T_S_FIELD_TRANSLATION_FTL VALUES ("T_HOUSEHOLD_HSH", "HSH_SURVEY_TYPIST", "??", "En")^
INSERT INTO T_S_FIELD_TRANSLATION_FTL VALUES ("T_HOUSEHOLD_HSH", "HSH_SURVEY_TYPIST", "??", "Fr")^
INSERT INTO T_S_FIELD_FLD             VALUES ("T_HOUSEHOLD_HSH", "HSH_SURVEY_SUPERVISOR", "??", 6, 0, "", FALSE, FALSE, 4, "LONG", "", "?? is a integer field")^
INSERT INTO T_S_FIELD_TRANSLATION_FTL VALUES ("T_HOUSEHOLD_HSH", "HSH_SURVEY_SUPERVISOR", "??", "En")^
INSERT INTO T_S_FIELD_TRANSLATION_FTL VALUES ("T_HOUSEHOLD_HSH", "HSH_SURVEY_SUPERVISOR", "??", "Fr")^
INSERT INTO T_S_FIELD_FLD             VALUES ("T_HOUSEHOLD_HSH", "HSH_VISIT_DAY", "??", 7, 0, "", TRUE, FALSE, 0, "INTEGER", "", "?? is a text field of 0 char(s) mandatory")^
INSERT INTO T_S_FIELD_TRANSLATION_FTL VALUES ("T_HOUSEHOLD_HSH", "HSH_VISIT_DAY", "??", "En")^
INSERT INTO T_S_FIELD_TRANSLATION_FTL VALUES ("T_HOUSEHOLD_HSH", "HSH_VISIT_DAY", "??", "Fr")^
INSERT INTO T_S_FIELD_FLD             VALUES ("T_HOUSEHOLD_HSH", "HSH_VISIT_MONTH", "??", 8, 0, "", TRUE, FALSE, 0, "INTEGER", "", "?? is a text field of 0 char(s) mandatory")^
INSERT INTO T_S_FIELD_TRANSLATION_FTL VALUES ("T_HOUSEHOLD_HSH", "HSH_VISIT_MONTH", "??", "En")^
INSERT INTO T_S_FIELD_TRANSLATION_FTL VALUES ("T_HOUSEHOLD_HSH", "HSH_VISIT_MONTH", "??", "Fr")^
INSERT INTO T_S_FIELD_FLD             VALUES ("T_HOUSEHOLD_HSH", "HSH_VISIT_YEAR", "??", 9, 0, "", TRUE, FALSE, 0, "INTEGER", "", "?? is a text field of 0 char(s) mandatory")^
INSERT INTO T_S_FIELD_TRANSLATION_FTL VALUES ("T_HOUSEHOLD_HSH", "HSH_VISIT_YEAR", "??", "En")^
INSERT INTO T_S_FIELD_TRANSLATION_FTL VALUES ("T_HOUSEHOLD_HSH", "HSH_VISIT_YEAR", "??", "Fr")^
INSERT INTO T_S_FIELD_FLD             VALUES ("T_HOUSEHOLD_HSH", "HSH_VISIT_RESULT", "??", 10, 0, "99", TRUE, FALSE, 2, "SMALLINT", "1 OR 2 OR 3 OR 4 OR 5 OR 6 OR 7 OR 8 OR 9 OR 10 OR 97 OR 99", "?? is a small integer field mandatory")^
INSERT INTO T_S_FIELD_TRANSLATION_FTL VALUES ("T_HOUSEHOLD_HSH", "HSH_VISIT_RESULT", "??", "En")^
INSERT INTO T_S_FIELD_TRANSLATION_FTL VALUES ("T_HOUSEHOLD_HSH", "HSH_VISIT_RESULT", "??", "Fr")^
INSERT INTO T_S_FIELD_FLD             VALUES ("T_INTERVIEWSUPERVISOR_IVW", "ISV_PRIMARYKEY", "??", 0, 0, "", TRUE, FALSE, 4, "AUTOINCREMENT", "", "?? is a integer field mandatory")^
INSERT INTO T_S_FIELD_TRANSLATION_FTL VALUES ("T_INTERVIEWSUPERVISOR_IVW", "ISV_PRIMARYKEY", "??", "En")^
INSERT INTO T_S_FIELD_TRANSLATION_FTL VALUES ("T_INTERVIEWSUPERVISOR_IVW", "ISV_PRIMARYKEY", "??", "Fr")^
INSERT INTO T_S_FIELD_FLD             VALUES ("T_INTERVIEWSUPERVISOR_IVW", "ISV_NAMEFIRST", "??", 1, 0, "", FALSE, FALSE, 32, "VARCHAR(32)", "", "?? is a text field of 32 char(s)")^
INSERT INTO T_S_FIELD_TRANSLATION_FTL VALUES ("T_INTERVIEWSUPERVISOR_IVW", "ISV_NAMEFIRST", "??", "En")^
INSERT INTO T_S_FIELD_TRANSLATION_FTL VALUES ("T_INTERVIEWSUPERVISOR_IVW", "ISV_NAMEFIRST", "??", "Fr")^
INSERT INTO T_S_FIELD_FLD             VALUES ("T_INTERVIEWSUPERVISOR_IVW", "ISV_NAMELAST", "??", 2, 0, "", FALSE, FALSE, 32, "VARCHAR(32)", "", "?? is a text field of 32 char(s)")^
INSERT INTO T_S_FIELD_TRANSLATION_FTL VALUES ("T_INTERVIEWSUPERVISOR_IVW", "ISV_NAMELAST", "??", "En")^
INSERT INTO T_S_FIELD_TRANSLATION_FTL VALUES ("T_INTERVIEWSUPERVISOR_IVW", "ISV_NAMELAST", "??", "Fr")^
INSERT INTO T_S_FIELD_FLD             VALUES ("T_SURVEYTYPIST_ISV", "ISV_PRIMARYKEY", "??", 0, 0, "", TRUE, FALSE, 4, "AUTOINCREMENT", "", "?? is a integer field mandatory")^
INSERT INTO T_S_FIELD_TRANSLATION_FTL VALUES ("T_SURVEYTYPIST_ISV", "ISV_PRIMARYKEY", "??", "En")^
INSERT INTO T_S_FIELD_TRANSLATION_FTL VALUES ("T_SURVEYTYPIST_ISV", "ISV_PRIMARYKEY", "??", "Fr")^
INSERT INTO T_S_FIELD_FLD             VALUES ("T_SURVEYTYPIST_ISV", "ISV_NAMEFIRST", "??", 1, 0, "", FALSE, FALSE, 32, "VARCHAR(32)", "", "?? is a text field of 32 char(s)")^
INSERT INTO T_S_FIELD_TRANSLATION_FTL VALUES ("T_SURVEYTYPIST_ISV", "ISV_NAMEFIRST", "??", "En")^
INSERT INTO T_S_FIELD_TRANSLATION_FTL VALUES ("T_SURVEYTYPIST_ISV", "ISV_NAMEFIRST", "??", "Fr")^
INSERT INTO T_S_FIELD_FLD             VALUES ("T_SURVEYTYPIST_ISV", "ISV_NAMELAST", "??", 2, 0, "", FALSE, FALSE, 32, "VARCHAR(32)", "", "?? is a text field of 32 char(s)")^
INSERT INTO T_S_FIELD_TRANSLATION_FTL VALUES ("T_SURVEYTYPIST_ISV", "ISV_NAMELAST", "??", "En")^
INSERT INTO T_S_FIELD_TRANSLATION_FTL VALUES ("T_SURVEYTYPIST_ISV", "ISV_NAMELAST", "??", "Fr")^
INSERT INTO T_S_FIELD_FLD             VALUES ("T_SURVEYSUPERVISOR_STP", "ISV_PRIMARYKEY", "??", 0, 0, "", TRUE, FALSE, 4, "AUTOINCREMENT", "", "?? is a integer field mandatory")^
INSERT INTO T_S_FIELD_TRANSLATION_FTL VALUES ("T_SURVEYSUPERVISOR_STP", "ISV_PRIMARYKEY", "??", "En")^
INSERT INTO T_S_FIELD_TRANSLATION_FTL VALUES ("T_SURVEYSUPERVISOR_STP", "ISV_PRIMARYKEY", "??", "Fr")^
INSERT INTO T_S_FIELD_FLD             VALUES ("T_SURVEYSUPERVISOR_STP", "ISV_NAMEFIRST", "??", 1, 0, "", FALSE, FALSE, 32, "VARCHAR(32)", "", "?? is a text field of 32 char(s)")^
INSERT INTO T_S_FIELD_TRANSLATION_FTL VALUES ("T_SURVEYSUPERVISOR_STP", "ISV_NAMEFIRST", "??", "En")^
INSERT INTO T_S_FIELD_TRANSLATION_FTL VALUES ("T_SURVEYSUPERVISOR_STP", "ISV_NAMEFIRST", "??", "Fr")^
INSERT INTO T_S_FIELD_FLD             VALUES ("T_SURVEYSUPERVISOR_STP", "ISV_NAMELAST", "??", 2, 0, "", FALSE, FALSE, 32, "VARCHAR(32)", "", "?? is a text field of 32 char(s)")^
INSERT INTO T_S_FIELD_TRANSLATION_FTL VALUES ("T_SURVEYSUPERVISOR_STP", "ISV_NAMELAST", "??", "En")^
INSERT INTO T_S_FIELD_TRANSLATION_FTL VALUES ("T_SURVEYSUPERVISOR_STP", "ISV_NAMELAST", "??", "Fr")^

/* Informations sur les codes */

CREATE TABLE T_S_CODE_CDE (
  CDE_GROUP             TEXT(32),
  CDE_CODE              SMALLINT NOT NULL,
  CDE_DESCRIPTION_SHORT TEXT(32) NOT NULL,
  CONSTRAINT C_CDE_KP PRIMARY KEY (CDE_GROUP, CDE_CODE))^

CREATE TABLE T_S_CODE_TRANSLATION_CTL (
  CTL_GROUP       TEXT(32),
  CTL_CODE        SMALLINT NOT NULL,
  CTL_DESCRIPTION TEXT(32) NOT NULL,
  CTL_LANGUAGE    TEXT(2) NOT NULL,
  CONSTRAINT C_CDE_KP PRIMARY KEY (CTL_GROUP, CTL_CODE, CTL_LANGUAGE))^

CREATE VIEW V_S_CODE_CDE AS
  PARAMETERS [LANG] TEXT(2);
  SELECT
    CDE_GROUP,
    CDE_CODE,
    CDE_DESCRIPTION_SHORT,
    CTL_DESCRIPTION AS CDE_DESCRIPTION
  FROM
    T_S_CODE_CDE,
    T_S_CODE_TRANSLATION_CTL
  WHERE
    (CDE_GROUP = CTL_GROUP) AND
    (CDE_CODE  = CTL_CODE) AND
    (FTL_LANGUAGE=[LANG])^

INSERT INTO T_S_CODE_CDE             VALUES ('VISIT_RESULT','1','Completed')^
INSERT INTO T_S_CODE_CDE             VALUES ('VISIT_RESULT','2','No household member at home')^
INSERT INTO T_S_CODE_CDE             VALUES ('VISIT_RESULT','3','No competent respondent at home')^
INSERT INTO T_S_CODE_CDE             VALUES ('VISIT_RESULT','4','Entire household absent for extended pariod of time')^
INSERT INTO T_S_CODE_CDE             VALUES ('VISIT_RESULT','5','Postponed')^
INSERT INTO T_S_CODE_CDE             VALUES ('VISIT_RESULT','6','Refused')^
INSERT INTO T_S_CODE_CDE             VALUES ('VISIT_RESULT','7','Dwelling vacant')^
INSERT INTO T_S_CODE_CDE             VALUES ('VISIT_RESULT','8','Address not a dwelling')^
INSERT INTO T_S_CODE_CDE             VALUES ('VISIT_RESULT','9','Dwelling destroyed')^
INSERT INTO T_S_CODE_CDE             VALUES ('VISIT_RESULT','10','Dwelling not found')^
INSERT INTO T_S_CODE_CDE             VALUES ('VISIT_RESULT','97','Other')^
INSERT INTO T_S_CODE_CDE             VALUES ('VISIT_RESULT','99','Not specified')^

