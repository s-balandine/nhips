<project name="fuchia" basedir=".">

	<taskdef resource="net/sf/antcontrib/antlib.xml">
		<classpath>
			<pathelement location="D:\users\s-balandine\applications\outils de developpement\ant-contrib\ant-contrib-1.0b3.jar" />
		</classpath>
	</taskdef>

	<property name="check.file" value="survey.chk" />

	<target name="check" description="Create final check file">
		<concat destfile="${check.file}">
			<filelist dir=".">
				<file name="check header.chk" />
			</filelist>
		</concat>
		<for list="csrhmedg,csrhide,csrhsfde,csrhat,csrhib,csrhata,csrhta,csrhtl,csrhas,csrhos,csrhac,csrhg,csrhm,csrhg,csrhn,
	          hrhg,hrhchir,hrhgen,hrhpharm,hrhophtal,hrhgynobs,hrhpediat,hrhorl,hrhanesth,hrhautrea,hrhautreb,hrhautrec,hrhautred,
	          hrham,hrhtsup,hrhide,hrhtotats,hrhkine,hrhtdent,hrhtanes,hrhppharm,hrhtradio,hrhtlabo,hrhsfde,hrhas,
	          hrhtsani,hrhcompt,hrhsecret,hrhoprad,hrhtmaint,hrhchauf,hrhouspec,hrhcuis,hrhplant,hrhagsecu" param="var">
			<sequential>
				<concat destfile="${check.file}" append="true">
					<filelist dir=".">
						<file name="check resources.chk" />
					</filelist>
					<filterchain>
						<replacetokens>
							<token key="var" value="@{var}" />
						</replacetokens>
					</filterchain>
				</concat>
			</sequential>
		</for>
		<for list="cszra,cszra1,cszra2,cszrb,cszrb1,cszrb2,cszrnmab,cszrnmab1,cszrnmab2,cszrtot,cszrtot1,cszrtot2" param="var">
			<sequential>
				<concat destfile="${check.file}" append="true">
					<filelist dir=".">
						<file name="check population.chk" />
					</filelist>
					<filterchain>
						<replacetokens>
							<token key="var" value="@{var}" />
						</replacetokens>
					</filterchain>
				</concat>
			</sequential>
		</for>
		<for list="ehd, eha,cstmsec,cstmpluie" param="var">
			<sequential>
				<concat destfile="${check.file}" append="true">
					<filelist dir=".">
						<file name="check time.chk" />
					</filelist>
					<filterchain>
						<replacetokens>
							<token key="var" value="@{var}" />
						</replacetokens>
					</filterchain>
				</concat>
			</sequential>
		</for>
		<concat destfile="${check.file}" append="true">
			<filelist dir=".">
				<file name="check footer.chk" />
			</filelist>
		</concat>
	</target>

	<target name="build" description="Package survey">
		<zip destfile="../../build/survey.zip">
			<zipfileset dir="D:/users/s-balandine/applications/epidemiology tools/epidata/entry/v3.1" includes="*.exe" prefix="setup" />
			<zipfileset dir="D:/users/s-balandine/applications/epidemiology tools/epidata/entry/v3.1" includes="*.pdf" prefix="docs" />
			<fileset dir="." includes="survey.chk" />
			<fileset dir="." includes="survey.rec" />
			<fileset dir="." includes="survey.qes" />
			<fileset dir="." includes="readme.txt" />
		</zip>
	</target>

</project>
